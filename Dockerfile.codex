# Minimal Codex container used by accountbox.
# Installs Codex CLI from npm (latest by default).
#
# Upstream install docs:
# - https://developers.openai.com/codex/cli/
# - https://www.npmjs.com/package/@openai/codex

FROM node:22-bookworm-slim

ARG CODEX_NPM_SPEC=@openai/codex@latest

RUN apt-get update \
  && apt-get install -y --no-install-recommends ca-certificates \
  && rm -rf /var/lib/apt/lists/*

RUN npm i -g "${CODEX_NPM_SPEC}" \
  && codex -V \
  && npm cache clean --force

WORKDIR /work
ENTRYPOINT ["codex"]
